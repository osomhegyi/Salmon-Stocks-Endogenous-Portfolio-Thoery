#### Summary
This README summarizes the main purpose of the 8_compute_improved_passability.R script. The user will run all code lines to generate three functions in order to compute the improved passability for each population after conservation investment. The functions created in this script allow us to 1) determine the conservation budget allocated to each population for a given set of weights and conservation budget 2) improve the individual barrier pass score for each barrier that is mitigated from conservation investment and 3) compute the watershed passability for each population after investment.

#### Variables
- `budget_allocated_fcn`: function to compute the budget allocated to each population within the ESU.
- `budget_allocated_df`: a data frame of the budget allocated to each individual population from the overall conservation budget for the portfolio.
- `while_fcn`: function to allocate the specific budget allocated to a given population and to improve the passability score of each barrier that is mitigated for the budget allocated.
- `bpassage_invest_compute_fcn`: function to compute the passability after conservation investment for each population in the ESU.

#### Steps
1. Run code lines 3 - 7. The function `budget_allocated_fcn` computes the budget allocated to each population in the ESU based on the weight allocated to each population for a given portfolio and the overall portfolio budget. The budget allocated to each population is defined by the weight allocated to each population.
2. Run code line 9. The data frame `budget_allocated_df` is the output from the `budget_allocated_fcn`, which holds the specific budget allocated to each population for a given portfolio. It is not necessary to run this line in order to run the `optimize_fcn`, however if the user would like to identify the budget allocated to each population before simulating portfolios, they may run this code line.
3. Run code lines 13 - 37. The function `while_fcn` is used to improve the barrier pass score for each barrier that is mitigated with conservation investment. For each population, using the list of barriers sorted by stream level, stream ID, and barrier pass score along with the budget allocated to that population, this function uses a while loop to improve the total number of barriers, so long as the available budget remains. The while loop is used to determine the number of barriers to be mitigated for a given allocated conservation budget, shown by the vector ‘index_choice’. The ‘rows to change’ vector is then used to improve the barrier pass score from less than 1 to 1, for each barrier that is mitigated. Barriers that receive a pass score of 1, indicate that they do not impact stream passability.
4. Run code lines 40 - 136. The function `bpassage_invest_compute_fcn` is used to compute the watershed passability value for each population in the ESU after conservation investment. This function applies the two equations shown above to compute the overall watershed passability for a population. The function input is a dataframe that includes stream level, stream ID, and barrier passability information for each barrier within the watershed. The data is sorted sequentially by stream level, stream ID, and barrier passability. For each individual salmon population, the `bpassage_base_compute_fcn` function iterates across each stream level and across each stream ID within a stream level to determine the specific weight and passibility associated with each stream ID within a stream level. We expect barriers that are located closer to the mouth of a watershed to have greater influence on stream passability for pacific salmon, as opposed to barriers located higher up in the watershed. Therefore, to account for this in our calculation of stream passability, each barrier within a stream id and stream level receives a weight, based on the location of the barrier within the watershed. 

